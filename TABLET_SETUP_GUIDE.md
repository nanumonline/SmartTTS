# 📱 태블릿 PC 방송 송출 설정 가이드

## 🎯 시나리오

### 목표

1. **관리자 (다른 PC)**
   - 웹 서비스에서 스케줄 설정
   - 음원 송출 시간 및 채널 선택

2. **시스템 (자동)**
   - 설정된 시간에 오디오를 Hostinger 엔드포인트로 전송
   - 서버에 오디오 저장

3. **태블릿 PC (방송 장비 연결)**
   - 주기적으로 서버 확인 (10초마다)
   - 새로운 오디오 발견 시 자동 재생
   - 방송 장비로 출력 (RJ-45 또는 오디오 케이블)

---

## ✅ 구현 완료

### 1. 오디오 목록 API

**파일:** `api/broadcast/list.php`

**기능:**
- 저장된 오디오 파일 목록 조회
- 최신 파일 우선 정렬
- 다운로드 URL 제공

**사용법:**
```
GET https://nanum.online/tts/api/broadcast/list.php
GET https://nanum.online/tts/api/broadcast/list.php?limit=5
```

### 2. 태블릿 PC 플레이어

**파일:** `api/broadcast/player.html`

**기능:**
- 주기적으로 오디오 목록 확인 (10초마다)
- 새로운 오디오 발견 시 자동 재생
- 재생 상태 표시
- 수동 확인 및 폴링 제어

**사용법:**
```
https://nanum.online/tts/api/broadcast/player.html
https://nanum.online/tts/api/broadcast/player.html?channel_id=your-channel-id
```

---

## 📋 설정 방법

### 1단계: 파일 업로드

Hostinger 서버에 다음 파일 업로드:

1. `list.php` - 오디오 목록 API
2. `player.html` - 태블릿 PC 플레이어

**업로드 경로:**
```
public_html/tts/api/broadcast/
├── index.php      (기존)
├── test.php       (기존)
├── list.php       ← 새로 추가
└── player.html    ← 새로 추가
```

### 2단계: 태블릿 PC 설정

1. **태블릿 PC에서 브라우저 열기**
   - Chrome, Safari 등 권장

2. **플레이어 페이지 접속**
   ```
   https://nanum.online/tts/api/broadcast/player.html
   ```

3. **화면 고정 (선택사항)**
   - 브라우저 설정에서 화면 잠금 모드 활성화
   - 또는 키오스크 모드 사용

4. **방송 장비 연결**
   - RJ-45 케이블로 방송 장비 연결
   - 또는 오디오 케이블로 연결

### 3단계: 테스트

1. **관리자 (웹 서비스)**
   - 스케줄 관리에서 새 스케줄 생성
   - 전송 채널 선택 (엔드포인트: `https://nanum.online/tts/api/broadcast/`)
   - 시간 설정 (예: 5분 후)

2. **태블릿 PC**
   - 플레이어 페이지가 열려 있는지 확인
   - 상태가 "대기 중..." 또는 "재생 중..." 인지 확인

3. **자동 송출 확인**
   - 설정된 시간에 오디오가 자동으로 전송됨
   - 태블릿 PC가 자동으로 오디오를 재생
   - 방송 장비로 출력됨

---

## 🔧 작동 원리

### 1. 관리자가 스케줄 생성

- 웹 서비스에서 스케줄 생성
- 채널 선택 (엔드포인트: `https://nanum.online/tts/api/broadcast/`)

### 2. 자동 실행 (1분마다)

- Supabase Edge Function (`execute-schedules`) 실행
- 스케줄 확인
- 설정된 시간에 오디오를 엔드포인트로 POST 요청

### 3. 서버에서 오디오 저장

- Hostinger 서버 (`index.php`)가 오디오 수신
- `audio/` 폴더에 저장
- 로그 기록

### 4. 태블릿 PC가 오디오 확인 (10초마다)

- 플레이어 페이지가 `list.php`를 호출
- 최신 오디오 파일 확인
- 새로운 파일 발견 시 자동 재생

### 5. 오디오 재생

- HTML5 Audio API로 오디오 재생
- 방송 장비로 출력 (RJ-45 또는 오디오 케이블)

---

## 💡 사용 팁

### 1. 태블릿 PC 화면 고정

**Android:**
- 설정 → 앱 → Chrome → 화면 고정

**iOS:**
- 설정 → 화면 시간 → 앱 제한

**또는 키오스크 모드:**
- 브라우저 키오스크 모드 사용

### 2. 자동 재생 설정

- 일부 브라우저는 사용자 상호작용 후에만 자동 재생 허용
- 플레이어 페이지를 한 번 클릭하면 자동 재생 활성화

### 3. 네트워크 연결 확인

- 태블릿 PC가 인터넷에 연결되어 있어야 함
- 방송 장비와 네트워크 연결 확인

### 4. 방송 장비 출력 확인

- 태블릿 PC 오디오 출력이 방송 장비로 연결되어 있는지 확인
- 볼륨 설정 확인

---

## 📝 체크리스트

### 파일 업로드
- [ ] `list.php` 업로드 완료
- [ ] `player.html` 업로드 완료
- [ ] 파일 권한 644 설정

### 태블릿 PC 설정
- [ ] 브라우저 설치 (Chrome, Safari 등)
- [ ] 플레이어 페이지 접속
- [ ] 화면 고정 설정 (선택사항)
- [ ] 방송 장비 연결 확인

### 테스트
- [ ] 플레이어 페이지 정상 표시
- [ ] 상태 메시지 확인 ("대기 중..." 또는 "재생 중...")
- [ ] 오디오 목록 표시 확인
- [ ] 스케줄 생성 및 자동 재생 테스트

---

## 🚀 다음 단계

1. **파일 업로드**
   - Hostinger 서버에 `list.php`와 `player.html` 업로드

2. **태블릿 PC 설정**
   - 플레이어 페이지 접속
   - 화면 고정 설정

3. **테스트**
   - 스케줄 생성
   - 자동 재생 확인

---

**이제 태블릿 PC에서 플레이어 페이지를 열고 테스트해보세요!** 🚀

